# sql执行过程

## 客户端

将sql语句交给server执行

## server层

1. 连接器：校验当前用户权限

2. 分析器：词法分析、语法分析

3. 优化器：选择使用的索引，生成执行计划

4. 执行器：调用引擎接口

## InnoDB

1. 将磁盘文件（ibd）加载到缓冲池（buffer pool）
2. undo log 持久化（InnoDB特有）（事务回滚）
3. 向buffer pool中写入数据
4. redo log 生成（InnoDB特有）（写入缓存）
5. redo log 持久化（InnoDB特有）
6. bin log 持久化（属于server层）
7. 向redo log写入commit标记（该标记表示redo log与bin log一致）（提交事务）
8. 另一个数据库线程将buffer pool刷新到磁盘中

# 数据库重启过程

todo

# 索引类型

按类型：b+ 哈希 全文

是否存储数据：聚簇索引、非聚簇索引

字段特性：主键 唯一 普通 前缀

字段个数：单列索引 联合索引



# 索引失效情况

1. 模糊查询
2. 索引与查询类型不一致
3. 最左前缀
4. 小表
5. 大量重复数据
6. 排序字段不为索引字段
7. 达到回表阈值
8. OR连接条件不为同一字段且不同字段未建立索引
9. 使用函数或对索引值做运算
10. 条件含有不等于
11. 唯一索引为NULL

todo：具体优化策略

# MVCC

todo

